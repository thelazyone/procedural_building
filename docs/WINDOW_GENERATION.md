# Window Generation

## Overview

Windows are generated using the same collision-aware placement algorithm as doors, but with different parameters and behavior.

## Key Differences from Doors

| Feature | Doors | Windows |
|---------|-------|---------|
| **Floors** | Ground floor only | All floors |
| **Spacing** | 2.0m between doors | 0.5m between windows |
| **Size** | 0.8m-1.0m × 2.5m | 1.2m × 1.5m-1.6m |
| **Elevation** | Ground level | 0.9m from floor |
| **Collision** | With each other | With doors AND windows |

## Window Properties

### WindowProperties Class
Generated by `WindowGenerator`, includes:
- **width**: Window width (default: 1.2m)
- **height**: Window height (default: 1.5m, 1.6m on ground floor)
- **elevation**: Height from floor to window sill (default: 0.9m)
- **style**: Window style (default: "standard")

## Placement Logic

### 1. Collision Avoidance
Windows avoid:
- **Doors**: Inherit occupied segments from door generation
- **Other windows**: Track window placements
- **Edge corners**: Respect `edge_spacing` (1.0m)

### 2. Floor-Specific Behavior

**Ground Floor:**
- Windows avoid door positions
- Slightly taller windows (1.6m vs 1.5m)
- Window density parameter: 0.2-0.5 recommended

**Upper Floors:**
- No doors to avoid
- Standard window height (1.5m)
- Can place windows in same positions as ground floor doors

## Parameters

### Exposed in UI
- **window_density**: Windows per meter of perimeter (default: 0.3)
  - Example: 40m perimeter × 0.3 = 12 windows

### Hidden Parameters
- **window_spacing**: 0.5m (min distance between windows)
- **edge_spacing**: 1.0m (distance from corners)
- **elevation**: 0.9m (window sill height)

## Test Results

### 40m Perimeter Building, 2 Floors

**Ground Floor (window_density=0.2):**
```
Doors: 2
Windows: 12
- Windows distributed across all 4 edges
- Windows avoid both door positions
- 0.5m spacing maintained
```

**Upper Floor (window_density=0.2):**
```
Doors: 0
Windows: 12
- Similar distribution to ground floor
- Can use positions where ground floor has doors
```

**With Higher Density (window_density=0.5):**
```
Ground Floor:
- Doors: 2
- Windows: 20+
- Distribution: Edge 0: 5, Edge 1: 5, Edge 2: 6, Edge 3: 5
```

## Visualization

In debug viewer:
- **Light blue rectangles** with transparency
- **Dark blue outline**
- Positioned at correct elevation on each floor
- Toggle with "Show Windows" checkbox

## Future Enhancements

### Vertical Alignment (Requested)
Windows can be aligned across floors:
```python
# Option 1: Exact vertical alignment
for floor in floors:
    use_same_positions_as_ground_floor()

# Option 2: Aligned with jitter
for floor in floors:
    base_positions = ground_floor_positions
    add_small_random_offset()  # ±10cm
```

Parameter: `align_windows_vertically` (bool, default: False)

### Window Types
- **Large windows**: 2.0m × 2.0m (for ground floor commercial)
- **Narrow windows**: 0.6m × 1.8m (for bathrooms)
- **Bay windows**: Multi-segment windows that protrude
- **Arched windows**: Decorative tops

### Smart Placement
- Avoid placing windows where rooms might need privacy (bathrooms)
- Larger windows near building entrances
- Symmetrical placement on facade

## Code Structure

```
FloorGenerator.generate()
  ├─► _generate_door_placements()
  │   └─► Returns (placements, occupied_segments)
  │
  └─► _generate_window_placements(door_occupied_segments)
      ├─► Inherits door collision map
      ├─► Adds window collision tracking
      └─► Returns window placements
```

Windows are placed AFTER doors to respect door positions and create realistic facades.
